<!DOCTYPE html>
<html>
<body>
<span id="ajaxButton" style="cursor: pointer; text-decoration: underline">
Get Weather
</span>
<script type="text/javascript">
    (function() {
        var httpRequest;
        document.getElementById("ajaxButton").onclick = function() {
            var url = 'https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%20in%20%28select%20woeid%20from%20geo.places%281%29%20where%20text%3D%22lyon%22%29&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys';
            makeRequest(url);
        };

        function makeRequest(url) {
            if (window.XMLHttpRequest) { // Mozilla, Safari, ...
                httpRequest = new XMLHttpRequest();
            } else {
                alert('Giving up :( Cannot create an XMLHTTP instance');
                return false;
            }
            httpRequest.onreadystatechange = alertContents;
            httpRequest.open('GET', url);
            httpRequest.send();
        }

        function alertContents() {
            if (httpRequest.readyState === 4) {
                if (httpRequest.status === 200) {
                    var weatherResponse = JSON.parse(httpRequest.responseText);
                    var weatherLabels = ["tornado", "tropical storm", "hurricane", "severe thunderstorms", "thunderstorms", "mixed rain and snow", "mixed rain and sleet", "mixed snow and sleet", "freezing drizzle", "drizzle", "freezing rain", "showers", "showers", "snow flurries", "light snow showers", "blowing snow", "snow", "hail", "sleet", "dust", "foggy", "haze", "smoky", "blustery", "windy", "cold", "cloudy", "mostly cloudy (night)", "mostly cloudy (day)", "partly cloudy (night)", "partly cloudy (day)", "clear (night)", "sunny", "fair (night)", "fair (day)", "mixed rain and hail", "hot", "isolated thunderstorms", "scattered thunderstorms", "scattered thunderstorms", "scattered showers", "heavy snow", "scattered snow showers", "heavy snow", "partly cloudy", "thundershowers", "snow showers", "isolated thundershowers", "not available"];
                    var todayForecast = weatherResponse.query.results.channel.item.forecast[0];
                    var weatherLabel = weatherLabels[todayForecast.code];
                    var low = todayForecast.low;
                    var high = todayForecast.high;
                    alert(weatherLabel + " " + low + "-" + high);
                } else {
                    alert('There was a problem with the request.');
                }
            }
        }
    })();
</script>
</body>
